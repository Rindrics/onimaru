# 0010. Parquet データへのアクセス方法

## Status

Accepted

## Context

データはParquet形式で配信するが（[ref](./0003-データ形式の選択.md)）、R や Python からアクセスする際には、ユーザーが Parquet 形式を意識せずにデータフレームとして利用できるようにしたい。

## Decision

ブラウザ分析環境のスタートアップ時に Parquet ファイルを読み込んでデータフレームに変換し、グローバル変数として保持する

## Consequences

- **メリット**
  - 実装がシンプルで容易
  - ユーザーは追加の読み込み処理を書く必要がない
  - すぐにデータを利用できる
  - パッケージの開発・メンテナンスが不要
- **デメリット**
  - グローバル変数が増える
  - メモリ使用量が増える可能性（ただし、データサイズが 5MB 程度なので問題なし）
  - データが大きい場合、初期化に時間がかかる可能性

## 実装方針

- WebR（R）: 初期化時に `arrow::read_parquet()` を使用してParquetファイルを読み込み、`ctd_data` という変数名で提供
- Pyodide（Python）: 初期化時に `pandas.read_parquet()` を使用してParquetファイルを読み込み、`ctd_data` という変数名で提供
- ユーザーは `ctd_data` という変数名で直接データフレームにアクセスできる

