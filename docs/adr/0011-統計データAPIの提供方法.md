# 0011. 統計データ API の提供方法

## Status

Accepted

## Context

ダッシュボードページで統計データを表示する必要がある。
Parquet ファイルから統計情報を取得して提供する方法を決定する必要がある。

## Decision

`/api/stats` という API ルートを提供し、基本的な統計情報（レコード数など）を返す方式を選択する

## Consequences

- **メリット**
  - サーバーサイドで Parquet ファイルを読み込むため、クライアント側の負荷が軽い
  - API として分離されているため、複数のページから再利用可能
  - 将来的に統計情報を拡張しやすい
- **デメリット**
  - Parquet ファイルを毎回読み込むため、レスポンス時間がかかる可能性がある
  - ただし、キャッシュ機能で対応（[ref](./0012-クライアント側キャッシュの実装方法.md)）

## 実装方針

- Next.jsの API Route（`app/api/stats/route.ts`）を使用
- JSON 形式で統計情報を返す

## 将来の拡張について

Rechartsを使用してグラフを表示する場合：
- `/api/stats` は基本的な統計情報（レコード数、データ範囲など）を提供し続ける
- グラフ用の集計データが必要な場合は、別の API エンドポイント（例：`/api/chart-data`）を作成する
- これにより、API の責務を分離し、各 API が特定の用途に最適化できる

